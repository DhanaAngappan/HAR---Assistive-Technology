


<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Record Video from Camera and Save as MP4</title>
</head>
<body>
  <video id="video" width="640" height="480" autoplay></video>
  <button id="startButton">Start Recording</button>
  <button id="stopButton" disabled>Stop Recording</button>
  <br>
  Your predicted number: <span id="prediction">{{ prediction }}</span>
  
  <script>
    let mediaRecorder;
    let chunks = [];

    const startButton = document.getElementById('startButton');
    const stopButton = document.getElementById('stopButton');
    const video = document.getElementById('video');

    // Get access to the camera
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(function (stream) {
        video.srcObject = stream;
        mediaRecorder = new MediaRecorder(stream);

        mediaRecorder.ondataavailable = function (event) {
          chunks.push(event.data);
        };

        mediaRecorder.onstop = function () {
          // Convert chunks to Blob
          const blob = new Blob(chunks, { type: 'video/mp4' });

          // Create FormData object to send file to server
          const formData = new FormData();
          formData.append('video', blob, 'video.mp4');

          // Send POST request to Flask server
          fetch('/save_video', {
            method: 'POST',
            body: formData
          })
          .then(response => {
            console.log('Video saved successfully:', response);
          })
          .catch(error => {
            console.error('Error saving video:', error);
          });
        };
      })
      .catch(function (error) {
        console.log('Error accessing the camera:', error);
      });

    // Start recording
    startButton.addEventListener('click', function () {
      chunks = [];
      mediaRecorder.start();
      startButton.disabled = true;
      stopButton.disabled = false;
    });

    // Stop recording
    stopButton.addEventListener('click', function () {
      mediaRecorder.stop();
      startButton.disabled = false;
      stopButton.disabled = true;
    });
  </script>
</body>
</html>
